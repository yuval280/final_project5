if(typeof PhpDebugBar>"u"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(a){PhpDebugBar.Widgets={};var s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),v=PhpDebugBar.Widgets.htmlize=function(t){return t.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},W=PhpDebugBar.Widgets.renderValue=function(t,e){return typeof t!="string"?e?v(JSON.stringify(t,void 0,2)):JSON.stringify(t):t},y=PhpDebugBar.Widgets.highlight=function(t,e){return typeof t=="string"?typeof hljs>"u"?v(t):e&&hljs.getLanguage(e)?hljs.highlight(t,{language:e}).value:hljs.highlightAuto(t).value:(typeof hljs=="object"&&t.each(function(i,n){hljs.highlightElement(n)}),t)},C=PhpDebugBar.Widgets.createCodeBlock=function(t,e,i,n){var d=a("<pre />").addClass(s("code-block")),l=a("<code />").text(t+`
`).appendTo(d);if(e&&l.addClass("language-"+e),y(l).removeClass("hljs"),!isNaN(parseFloat(i))){var r=t.split(`
`).length,c=a("<ul />").prependTo(d);d.children().addClass(s("numbered-code"));for(var p=i;p<i+r;p++){var o=a("<li />").text(p).appendTo(c);n===p&&o.addClass(s("highlighted-line")).append("<span>&nbsp;</span>")}}return d},w=PhpDebugBar.utils.getDictValue=function(t,e,i){for(var n=t,d=e.split("."),l=0;l<d.length;l++){if(!n[d[l]])return i;n=n[d[l]]}return n},k=PhpDebugBar.Widgets.ListWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("list"),initialize:function(t){t.itemRenderer||(t.itemRenderer=this.itemRenderer),this.set(t)},render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data"))for(var t=this.get("data"),e=0;e<t.length;e++){var i=a("<li />").addClass(s("list-item")).appendTo(this.$el);this.get("itemRenderer")(i,t[e])}})},itemRenderer:function(t,e){t.html(W(e))}}),_=PhpDebugBar.Widgets.KVListWidget=k.extend({tagName:"dl",className:s("kvlist"),render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data")){var t=this;a.each(this.get("data"),function(e,i){var n=a("<dt />").addClass(s("key")).appendTo(t.$el),d=a("<dd />").addClass(s("value")).appendTo(t.$el);t.get("itemRenderer")(n,d,e,i)})}})},itemRenderer:function(t,e,i,n){t.text(i),e.html(v(n))}}),S=PhpDebugBar.Widgets.VariableListWidget=_.extend({className:s("kvlist varlist"),itemRenderer:function(t,e,i,n){a("<span />").attr("title",i).text(i).appendTo(t);var d=n&&n.value||n;d&&d.length>100&&(d=d.substr(0,100)+"...");var l=null;e.text(d).click(function(){e.hasClass(s("pretty"))?e.text(d).removeClass(s("pretty")):(l=l||C(n),e.addClass(s("pretty")).empty().append(l))})}}),A=PhpDebugBar.Widgets.HtmlVariableListWidget=_.extend({className:s("kvlist htmlvarlist"),itemRenderer:function(t,e,i,n){if(a("<span />").attr("title",a("<i />").html(i||"").text()).html(i||"").appendTo(t),e.html(n&&n.value||n),n&&n.xdebug_link){var d=a("<span />").addClass(s("filename")).text(n.xdebug_link.filename+(n.xdebug_link.line?"#"+n.xdebug_link.line:""));n.xdebug_link&&(n.xdebug_link.ajax?a('<a title="'+n.xdebug_link.url+'"></a>').on("click",function(){a.ajax(n.xdebug_link.url)}).addClass(s("editor-link")).appendTo(d):a('<a href="'+n.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(d)),d.appendTo(e)}}}),E=PhpDebugBar.Widgets.IFrameWidget=PhpDebugBar.Widget.extend({tagName:"iframe",className:s("iframe"),render:function(){this.$el.attr({seamless:"seamless",border:"0",width:"100%",height:"100%"}),this.bindAttr("data",function(t){this.$el.attr("src",t)})}}),F=PhpDebugBar.Widgets.MessagesWidget=PhpDebugBar.Widget.extend({className:s("messages"),render:function(){var t=this;this.$list=new k({itemRenderer:function(e,i){if(i.message_html)var n=a("<span />").addClass(s("value")).html(i.message_html).appendTo(e);else{var d=i.message;d.length>100&&(d=d.substr(0,100)+"...");var n=a("<span />").addClass(s("value")).text(d).appendTo(e);if(!i.is_string||i.message.length>100){var l=i.message;i.is_string||(l=null),e.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";n.hasClass(s("pretty"))?n.text(d).removeClass(s("pretty")):(l=l||C(i.message,"php"),n.addClass(s("pretty")).empty().append(l))})}}if(i.xdebug_link){var r=a("<span />").addClass(s("filename")).text(i.xdebug_link.filename+(i.xdebug_link.line?"#"+i.xdebug_link.line:""));i.xdebug_link&&(i.xdebug_link.ajax?a('<a title="'+i.xdebug_link.url+'"></a>').on("click",function(){a.ajax(i.xdebug_link.url)}).addClass(s("editor-link")).appendTo(r):a('<a href="'+i.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(r)),r.appendTo(e)}i.collector&&a("<span />").addClass(s("collector")).text(i.collector).prependTo(e),i.label&&(n.addClass(s(i.label)),a("<span />").addClass(s("label")).text(i.label).prependTo(e))}}),this.$list.$el.appendTo(this.$el),this.$toolbar=a('<div><i class="phpdebugbar-fa phpdebugbar-fa-search"></i></div>').addClass(s("toolbar")).appendTo(this.$el),a('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("change",function(){t.set("search",this.value)}).appendTo(this.$toolbar),this.bindAttr("data",function(e){this.set({excludelabel:[],excludecollector:[],search:""}),this.$toolbar.find(s(".filter")).remove();var i=[],n=[],d=this,l=function(r,c){a("<a />").addClass(s("filter")).addClass(s(r)).text(c).attr("rel",c).on("click",function(){d.onFilterClick(this,r)}).appendTo(d.$toolbar)};e.forEach(function(r){i.includes(r.label||"none")||i.push(r.label||"none"),n.includes(r.collector||"none")||n.push(r.collector||"none")}),i.length>1&&i.forEach(r=>l("label",r)),n.length!==1&&(a("<a />").addClass(s("filter")).css("visibility","hidden").appendTo(d.$toolbar),n.forEach(r=>l("collector",r)))}),this.bindAttr(["excludelabel","excludecollector","search"],function(){var e=this.get("excludelabel")||[],i=this.get("excludecollector")||[],n=this.get("search"),d=!1,l=[];n&&n===n.toLowerCase()&&(d=!0),this.get("data").forEach(function(r){var c=d?r.message.toLowerCase():r.message;!e.includes(r.label||void 0)&&!i.includes(r.collector||void 0)&&(!n||c.indexOf(n)>-1)&&l.push(r)}),this.$list.set("data",l)})},onFilterClick:function(t,e){a(t).toggleClass(s("excluded"));var i=[];this.$toolbar.find(s(".filter")+s(".excluded")+s("."+e)).each(function(){i.push(this.rel==="none"||!this.rel?void 0:this.rel)}),this.set("exclude"+e,i)}}),M=PhpDebugBar.Widgets.TimelineWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("timeline"),render:function(){this.bindAttr("data",function(t){var e=function(h){return h<.001?(h*1e6).toFixed()+"\u03BCs":h<.1?(h*1e3).toFixed(2)+"ms":h<1?(h*1e3).toFixed()+"ms":h.toFixed(2)+"s"},i=function(g){if(g===0||g===null)return"0B";var R=g<0?"-":"",g=Math.abs(g),T=Math.log(g)/Math.log(1024),j=["B","KB","MB","GB","TB"];return R+Math.round(Math.pow(1024,T-Math.floor(T))*100)/100+j[Math.floor(T)]};if(this.$el.empty(),t.measures){for(var n={},d=0;d<t.measures.length;d++){var l=t.measures[d],r=l.group||l.label;n[r]||(n[r]={count:0,duration:0,memory:0}),n[r].count+=1,n[r].duration+=l.duration,n[r].memory+=l.memory||0;var c=a("<div />").addClass(s("measure")),p=a("<li />"),o=(l.relative_start*100/t.duration).toFixed(2),u=Math.min((l.duration*100/t.duration).toFixed(2),100-o);if(c.append(a("<span />").addClass(s("value")).css({left:o+"%",width:u+"%"})),c.append(a("<span />").addClass(s("label")).text(l.label.replace(/\s+/g," ")+(l.duration?" ("+l.duration_str+(l.memory?"/"+l.memory_str:"")+")":""))),l.collector&&a("<span />").addClass(s("collector")).text(l.collector).appendTo(c),c.appendTo(p),this.$el.append(p),l.params&&!a.isEmptyObject(l.params)){var x=a('<table><tr><th colspan="2">Params</th></tr></table>').hide().addClass(s("params")).appendTo(p);for(var m in l.params)typeof l.params[m]!="function"&&x.append('<tr><td class="'+s("name")+'">'+m+'</td><td class="'+s("value")+'"><pre><code>'+l.params[m]+"</code></pre></td></tr>");p.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";var h=a(this).find("table");h.is(":visible")?h.hide():h.show()})}}n=a.map(n,function(h,f){return{label:f,data:h}}).sort(function(h,f){return f.data.duration-h.data.duration});var b=a("<table></table>").addClass(s("params"));a.each(n,function(h,f){u=Math.min((f.data.duration*100/t.duration).toFixed(2),100),b.append('<tr><td class="'+s("name")+'">'+f.data.count+" x "+a("<i />").text(f.label.replace(/\s+/g," ")).html()+" ("+u+'%)</td><td class="'+s("value")+'"><div class="'+s("measure")+'"><span class="'+s("value")+'"></span><span class="'+s("label")+'">'+e(f.data.duration)+(f.data.memory?"/"+i(f.data.memory):"")+"</span></div></td></tr>"),b.find("span."+s("value")+":last").css({width:u+"%"})}),this.$el.append("<li/>").find("li:last").append(b)}})}}),N=PhpDebugBar.Widgets.ExceptionsWidget=PhpDebugBar.Widget.extend({className:s("exceptions"),render:function(){this.$list=new k({itemRenderer:function(t,e){if(a("<span />").addClass(s("message")).text(e.message).appendTo(t),e.file){var i=a("<span />").addClass(s("filename")).text(e.file+"#"+e.line);e.xdebug_link&&(e.xdebug_link.ajax?a('<a title="'+e.xdebug_link.url+'"></a>').on("click",function(){fetch(e.xdebug_link.url)}).addClass(s("editor-link")).appendTo(i):a('<a href="'+e.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(i)),i.appendTo(t)}if(e.type&&a("<span />").addClass(s("type")).text(e.type).appendTo(t),e.surrounding_lines){var n=e.line-3<=0?1:e.line-3,d=C(e.surrounding_lines.join(""),"php",n,e.line).addClass(s("file")).appendTo(t);e.stack_trace_html||t.click(function(){d.is(":visible")?d.hide():d.show()})}if(e.stack_trace_html){var l=a("<span />").addClass(s("filename")).html(e.stack_trace_html);l.appendTo(t)}else e.stack_trace&&e.stack_trace.split(`
`).forEach(function(r){var c=a("<div />");a("<span />").addClass(s("filename")).text(r).appendTo(c),c.appendTo(t)})}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(t){this.$list.set("data",t),t.length==1&&this.$list.$el.children().first().find(s(".file")).show()})}}),L=PhpDebugBar.Widgets.DatasetWidget=PhpDebugBar.Widget.extend({initialize:function(t){t.itemRenderer||(t.itemRenderer=this.itemRenderer),this.set(t),this.set("autoshow",null),this.set("id",null),this.set("sort",localStorage.getItem("debugbar-history-sort")||"asc"),this.$el.addClass(s("dataset-history")),this.renderHead()},renderHead:function(){this.$el.empty(),this.$actions=a("<div />").addClass(s("dataset-actions")).appendTo(this.$el);var t=this,e=t.get("debugbar");this.$autoshow=a("<input type=checkbox>").on("click",function(){e.ajaxHandler&&e.ajaxHandler.setAutoShow(a(this).is(":checked")),e.controls.__settings&&e.controls.__settings.get("widget").set("autoshow",this.autoShow)}),a("<label>Autoshow</label>").append(this.$autoshow).appendTo(this.$actions),this.$clearbtn=a("<a>Clear</a>").appendTo(this.$actions).on("click",function(){t.$table.empty()}),this.$showBtn=a("<a>Show all</a>").appendTo(this.$actions).on("click",function(){t.searchInput.val(null),t.methodInput.val(null),t.set("search",null),t.set("method",null)}),this.methodInput=a('<select name="method" style="width:100px"><option>(method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select>').on("change",function(){t.set("method",this.value)}).appendTo(this.$actions),this.searchInput=a('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("input",function(){t.set("search",this.value)}).appendTo(this.$actions),this.$table=a("<tbody />"),a("<table/>").append(a("<thead/>").append(a("<tr/>").append(a("<th></th>").css("width","30px")).append(a("<th>Date \u2195</th>").css("width","175px").click(function(){t.set("sort",t.get("sort")==="asc"?"desc":"asc"),localStorage.setItem("debugbar-history-sort",t.get("sort"))})).append(a("<th>Method</th>").css("width","80px")).append(a("<th>URL</th>")).append(a('<th width="40%">Data</th>')))).append(this.$table).appendTo(this.$el)},renderDatasets:function(){this.$table.empty();var t=this;a.each(this.get("data"),function(e,i){i.__meta&&t.get("itemRenderer")(t,i)})},render:function(){this.bindAttr("data",function(){if(this.get("autoshow")===null&&this.get("debugbar").ajaxHandler&&this.set("autoshow",this.get("debugbar").ajaxHandler.autoShow),!!this.has("data")){var t=this.get("data"),e=t[Object.keys(t)[Object.keys(t).length-1]];e.__meta&&this.get("itemRenderer")(this,e)}}),this.bindAttr(["itemRenderer","search","method","sort"],function(){this.renderDatasets()}),this.bindAttr("autoshow",function(){var t=this.get("autoshow");this.$autoshow.prop("checked",t)}),this.bindAttr("id",function(){var t=this.get("id");this.$table.find("."+s("active")).removeClass(s("active")),this.$table.find("tr[data-id="+t+"]").addClass(s("active"))})},itemRenderer:function(t,e){var i=e.__meta,n=a("<td />"),d=a("<tr />");t.get("sort")==="asc"?d.appendTo(t.$table):d.prependTo(t.$table);var l=function(){var o=t.get("debugbar");o.showDataSet(i.id,o.datesetTitleFormater.format("",e,i.suffix,i.nb)),t.$table.find("."+s("active")).removeClass(s("active")),d.addClass(s("active")),a(this).data("tab")&&o.showTab(a(this).data("tab"))};d.attr("data-id",i.id).append(a("<td>#"+i.nb+"</td>").click(l)).append(a("<td>"+i.datetime+"</td>").click(l)).append(a("<td>"+i.method+"</td>").click(l)).append(a("<td />").append(i.uri+(i.suffix?" "+i.suffix:"")).click(l)).css("cursor","pointer").addClass(s("table-row"));var r=t.get("debugbar");a.each(r.dataMap,function(o,u){var x=w(e,u[0],u[1]);if(o.indexOf(":")!=-1)if(o=o.split(":"),o[1]==="badge"&&x>0){var m=r.getControl(o[0]),b=a("<a>").attr("title",m.get("title")).data("tab",o[0]);m.$icon&&b.append(r.getControl(o[0]).$icon.clone()),m.$badge&&b.append(r.getControl(o[0]).$badge.clone().css("display","inline-block").text(x)),b.appendTo(n).click(l)}else o[1]==="tooltip"&&r.getControl(o[0]).set("tooltip",x)}),d.append(n),r.activeDatasetId===i.id&&d.addClass(s("active"));var c=t.get("search"),p=t.get("method");(c&&i.uri.indexOf(c)==-1||p&&i.method!==p)&&d.hide()}})})(PhpDebugBar.$);
